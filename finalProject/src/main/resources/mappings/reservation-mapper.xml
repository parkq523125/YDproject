<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper
	namespace="com.company.reservation.service.impl.ReservationMapper">

	<!-- 예약 단건조회 -->
	<select id="getReservation" parameterType="ReservationVO"
		resultType="ReservationVO">
		SELECT RESERVATIONNUMBER
			, OPTIONNAME
			, TO_CHAR(RESERVATIONDATE, 'yyyy-mm-dd') AS RESERVATIONDATE
			, RESERVATIONSTATE
			, MEMBERID
			, PNDNUMBER
			, BISNUMBER
			, RESERVATIONTIME
		FROM RESERVATION
		WHERE
		PNDNUMBER=#{pndNumber}
	</select>
	
	<!-- 예약 리스트 조회 -->
	<select id="getSearchReservation" parameterType="ReservationVO"
		resultType="ReservationVO">
	SELECT RESERVATIONNUMBER
			, OPTIONNAME
			, TO_CHAR(RESERVATIONDATE, 'yyyy-mm-dd') AS RESERVATIONDATE
			, RESERVATIONSTATE
			, MEMBERID
			, PNDNUMBER
			, BISNUMBER
			, RESERVATIONTIME
		FROM RESERVATION
		where memberid=#{memberId}
		</select>


	<!-- 예약내역 view 조회 구매평등록하기 버튼 클릭시 필요한 값 -->
	<select id="getViewReservation" parameterType="ReservationVO"
		resultType="ReservationVO">
		SELECT * FROM REVIEWRESERVATION
		WHERE MEMBERID=#{memberId}
		AND BISNUMBER=#{bisNumber}
	</select>

	<!-- 예약하기 버튼눌러서 날짜선택시 Reservation DB update -->
	<update id="updateReservation" parameterType="ReservationVO">
		UPDATE RESERVATION SET 
			RESERVATIONDATE = TO_DATE(#{reservationDate}, 'yyyy-mm-dd')
		  ,	RESERVATIONTIME = #{reservationTime}
		  , RESERVATIONSTATE = '예약완료'
	WHERE PNDNUMBER=#{pndNumber}
	</update>
	
	
</mapper>